let OFFSET,SIDE=10,TRIG_H=55,TRIANGLES=[],ANIM_QUEUE=[],M=0.55,FR=0,MARGIN_TOP=-1e3;function setup(){createCanvas(600,600),noStroke();for(let a=0;a<SIDE;a++){TRIANGLES.push([]);for(let d,b=0;b<SIDE;b++)d=0==b%2,TRIANGLES[a].push(new triangle_(null,null,TRIG_H,d))}}function draw(){for(let a in background("#B0A990"),MARGIN_TOP=lerp(MARGIN_TOP,0,0.05),OFFSET=(width-SIDE*TRIG_H*(Math.sqrt(3)/2)*M)/2,60<FR&&100>FR&&(M=lerp(M,0.8,0.08)),100<FR&&ANIM_QUEUE.length<SIDE*SIDE&&(M=lerp(M,0.75,0.05),TRIG_H=lerp(TRIG_H,45,0.04),ANIM_QUEUE.push({from:0,to:-PI/6})),ANIM_QUEUE)ANIM_QUEUE[a].from=lerp(ANIM_QUEUE[a].from,ANIM_QUEUE[a].to,0.1);for(let a=0;a<SIDE;a++)for(let b=0;b<SIDE;b++){0==a%2?(fill("#202030"),stroke("#202030")):(61>FR?fill("#39304A"):noFill(),stroke("#39304A"));let d=OFFSET+(b+0.5)*TRIG_H*(Math.sqrt(3)/2)*M,e=OFFSET+(a+0.5)*TRIG_H*(Math.sqrt(3)/2)*M+MARGIN_TOP;TRIANGLES[a][b].x=d,TRIANGLES[a][b].y=e,push(),ANIM_QUEUE[a*SIDE+b]&&(translate(d,e),rotate(ANIM_QUEUE[a*SIDE+b].from),translate(-d,-e),stroke("#090C02"),0==a%2?fill("#090C02"):(noFill(),strokeWeight(1),stroke("#B0A990"))),TRIANGLES[a][b].draw(),pop()}240<FR&&(MARGIN_TOP=lerp(MARGIN_TOP,1e3,0.05),280<FR&&(FR=0,ANIM_QUEUE=[],MARGIN_TOP=-1e3,M=0.55,TRIG_H=50)),FR++}function triangle_(a,b,d,e){this.x=a,this.y=b,this.r=d,this.t=e}triangle_.prototype.draw=function(){let a=this.representPoints();triangle(a[0],a[1],a[2],a[3],a[4],a[5])},triangle_.prototype.representPoints=function(){let a=this.r*(Math.sqrt(3)/2);return this.t?[this.x,this.y-a/2,this.x-this.r/2,this.y+a/2,this.x+this.r/2,this.y+a/2]:[this.x-this.r/2,this.y-a/2,this.x+this.r/2,this.y-a/2,this.x,this.y+a/2]};